<html>

<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');

        body pre {
            background-color: #FFFFFF;
            color: #000000;
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            color: #000000;
            line-height: 12px;
        }

        iframe {
            overflow: none;
        }

        a {
            text-decoration: none;
            color: #000000;
        }
    </style>
</head>

<body>

    <pre>from bs4 import BeautifulSoup
from xlwt import Workbook
import requests
import xlwt
import xlrd
import re
import os


if __name__ == '__main__':
    try:
        path = os.path.dirname(os.path.realpath(__file__))
        os.chdir(path)

        if os.path.exists("geekbench.xls"):
            os.remove("geekbench.xls")
        else:
            pass

        # Workbook is created
        wb = Workbook()

        sheet1 = wb.add_sheet('Sheet 1')

        print("Which CPU are you looking for?", end="")
        x = input()
        print(" " + str(x))

        i = 1

        print("Number of sets?", end="")
        f = input()
        f = int(f)
        print(" " + str(f))

        print("Scraping " + str(f) + " set(s) for [" + x + "]...\n\n")

        while i <= f:

            k = "https://browser.geekbench.com/v5/cpu/search?page="
            l = str(i) + "&q=" + x + "&utf8=%E2%9C%93"

            URL = k + l

            headers = {
                "User-Agent": 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 OPR/67.0.3575.115'}

            page = requests.get(URL, headers=headers)
            soup = BeautifulSoup(
                page.content, 'html.parser', from_encoding="utf8")
            search_results = soup.findAll("span", class_="list-col-text-score")
            prices = soup.findAll("span", class_="tah")

            j = 0
            q = len(search_results)

            for search_result in search_results:
                if j % 2 == 0:
                    sheet1.write((q*(i-1))+j, 0,
                                    int(search_result.text.strip()))

                else:
                    sheet1.write((q*(i-1))+j, 1,
                                    int(search_result.text.strip()))
                j += 1
            i += 1

            wb.save('geekbench.xls')

        wb2 = xlrd.open_workbook('geekbench.xls')

        sheet2 = wb2.sheet_by_name('Sheet 1')
        sin_core = sheet2.col_values(0)
        mult_core = sheet2.col_values(1)

        lst = []
        for sin in sin_core:
            if type(sin) == float:
                lst.append(sin)
            else:
                pass
        print("Sample Size: " + str(len(lst)) + "\n")

        print("Your CPU has an average single-core score of: " +
                str(sum(lst)/len(lst)))
        print("Your CPU has an average single-core score of (250): " +
                str(int(sum(lst[0:250])/250)))

        lst = []
        for mult in mult_core:
            if type(mult) == float:
                lst.append(mult)
            else:
                pass
        print("Your CPU has an average multi-core score of: " +
                str(sum(lst)/len(lst)))
        print("Your CPU has an average multi-core score of (250): " +
                str(sum(lst[0:250])/250))

    except BaseException:
        import sys
        print(sys.exc_info()[0])
        import traceback
        print(traceback.format_exc())
    finally:
        pass
        # print("\n" + "Press 'Enter' to close the window :)")
        # input()

    </pre>

</body>

</html>